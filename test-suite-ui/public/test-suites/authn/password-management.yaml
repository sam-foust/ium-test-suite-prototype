metadata:
  title: "Password Management Regression Test Suite"
  feature: "Password Management"
  createdBy: "Sam Foust"
  dateCreated: "2025-12-09"
  lastUpdated: "2025-12-09"
  status: "Draft"

featureInformation:
  feature: "Password Management (Expired Password, Password Change, Forgot Password, Admin Temporary Password, Tenant Impersonation)"
  details:
    - "TC-01 - Expired Password Flow: User login with expired password, forced password change with validation (incorrect current password, password reuse prevention)"
    - "TC-02 - Authenticated Password Change: Voluntary password change from user menu while logged in"
    - "TC-03 - Forgot Password Flow: Username-based password reset request, email verification code, password reset with password history validation"
    - "TC-04 - Admin Temporary Password: Admin sets temporary password for another user, user forced to change password without current password requirement"
    - "TC-05 - Tenant Management Impersonation: ST account generates temporary impersonation password for mobile technician login (no password change required)"
    - "Platform Coverage: Web browser (Employee) and Mobile/Android Studio (Technician)"
    - "Password Validation: Password history enforcement, incorrect password handling, secure password change flow with logout/re-login"

preSetup:
  purpose: "Complete all prerequisite setups before beginning test execution for smooth, uninterrupted testing."
  tenantSetup:
    - "Create or use a tenant with MFA disabled"
  userAccounts:
    - prerequisite: "PRE-01 (Active Employee - Admin - MFA Disabled)"
      quantity: 2
      notes: "Create 2 employee accounts with admin role - use [Username1] + [AdminUsername] and [Password1] as variables (document actual values in Test Variables Tracker)"
    - prerequisite: "PRE-02 (Active Technician - MFA Disabled)"
      quantity: 1
      notes: "Create 1 technician account - use [Username2] and [Password1] as variables (document actual values in Test Variables Tracker)"
  checklistItems:
    - "Tenant with MFA disabled confirmed"
    - "2x PRE-01 Employee accounts (admin role) created with [Username1] + [AdminUsername] and [Password1]"
    - "1x PRE-02 Technician account created with [Username2] and [Password1]"
    - "All usernames and passwords documented in Test Variables Tracker section"

executionMatrix:
  important: "All test cases (TC-01, TC-02, TC-03) must be executed for BOTH user types on their respective platforms."
  matrix:
    - userType: "Employee #1 (PRE-01)"
      platform: "Web Browser"
      variableSet: "[Username1], [EmailAddress1], [Password1-5], [EmailCode1], [TempPassword]"
      executionStatus: "Incomplete"
    - userType: "Technician (PRE-02)"
      platform: "Mobile (Phone or Android Studio)"
      variableSet: "[Username2], [EmailAddress2], [Password1-5], [EmailCode2], [TempPassword], [ImpersonationPassword]"
      executionStatus: "Incomplete"
  instructions:
    - "Select a row from the Test Execution Matrix below"
    - "Map the generic test variables to your selected user's variables: [TestUser] → [Username1], or [Username2]; [TestEmail] → [EmailAddress1], or [EmailAddress2]; [TestEmailCode] → [EmailCode1] or [EmailCode2]"
    - "Execute test cases following the matrix instructions"
    - "Document any platform-specific issues in the Notes column of each test case"
  executionFlow:
    - "First Pass: Execute TC-01 through TC-04 using PRE-01 Employee #1 on web browser"
    - "Second Pass: Execute TC-04 using PRE-01 Employee #2 (admin) to set temporary password for Employee #1"
    - "Third Pass: Execute TC-01 through TC-03 using PRE-02 on mobile device or Android Studio"
    - "Fourth Pass: Execute TC-04 using PRE-01 Employee #2 (admin) on web to set temporary password for PRE-02, then test password change on mobile"
    - "Fifth Pass: Execute TC-05 using PRE-02 on mobile device or Android Studio (technician impersonation only)"

prerequisites:
  - id: "PRE-01"
    dataObject: "Active New Employee with Admin Role and supplied password (MFA Disabled)"
    steps:
      - "Ensure tenant has MFA disabled"
      - "Impersonate as owner"
      - "Go to employee add page"
      - "Create a new employee with [EmailAddress1] or [AdminEmailAddress]"
      - "Assign Admin role"
      - "Create user by supplying [Username1] or [AdminUsername] and [Password1]"
  - id: "PRE-02"
    dataObject: "Active New Technician with supplied password (MFA Disabled)"
    steps:
      - "Ensure tenant has MFA disabled"
      - "Impersonate as owner"
      - "Go to technician add page"
      - "Create a new technician with [EmailAddress2]"
      - "Create user by supplying [Username2] and [Password1]"

testVariables:
  - category: "PRE-01 Variables (Employee - Web)"
    variables:
      - name: "[Username1]"
        actualValue: ""
        notes: "Employee #1 username"
      - name: "[EmailAddress1]"
        actualValue: ""
        notes: "Employee #1 email address"
      - name: "[AdminUsername]"
        actualValue: ""
        notes: "Employee #2 username (admin)"
      - name: "[AdminEmailAddress]"
        actualValue: ""
        notes: "Employee #2 email address (admin)"
      - name: "[Password1]"
        actualValue: ""
        notes: "Initial supplied password"
      - name: "[Password2]"
        actualValue: ""
        notes: "Password set in TC-01.4"
      - name: "[Password3]"
        actualValue: ""
        notes: "Password set in TC-02.2"
      - name: "[EmailCode1]"
        actualValue: ""
        notes: "Verification code from forgot password email"
      - name: "[Password4]"
        actualValue: ""
        notes: "Password set in TC-03.5"
      - name: "[TempPassword]"
        actualValue: ""
        notes: "Temporary password set by admin in TC-04.2"
      - name: "[Password5]"
        actualValue: ""
        notes: "Password set in TC-04.4"
  - category: "PRE-02 Variables (Technician - Mobile)"
    variables:
      - name: "[Username2]"
        actualValue: ""
        notes: "Technician username"
      - name: "[EmailAddress2]"
        actualValue: ""
        notes: "Technician email address"
      - name: "[EmailCode2]"
        actualValue: ""
        notes: "Verification code from forgot password email"
      - name: "[ImpersonationPassword]"
        actualValue: ""
        notes: "Temporary impersonation password from tenant management"

testScenarios:
  - id: "TC-01"
    title: "Expired Password Flow"
    description: "Tests the forced password change when a user logs in with an expired password."
    testCases:
      - testId: "TC-01.1"
        title: "Login with Expired Password - Initial Login"
        prerequisiteReference: "Uses PRE-01 or PRE-02"
        actionSteps:
          - "Go to root application URL in a new browser session"
          - "Enter [TestUser] and [Password1] from prerequisite"
          - "Submit login"
        expectedResult:
          - "User is redirected to login page"
          - "After login, system prompts that current password is expired"
          - "User is presented with password change form"
        notes: ""
      - testId: "TC-01.2"
        title: "Login with Expired Password - Incorrect Current Password"
        prerequisiteReference: "Continues from TC-01.1"
        actionSteps:
          - "Enter INCORRECT current password"
          - "Enter new password (different from [Password1])"
          - "Save"
        expectedResult:
          - "Error message: \"Unable to change password because password is incorrect\""
          - "Password is NOT changed"
          - "User remains on password change screen"
        notes: ""
      - testId: "TC-01.3"
        title: "Login with Expired Password - Reusing Current Password"
        prerequisiteReference: "Continues from TC-01.1"
        actionSteps:
          - "Enter [Password1] as current password"
          - "Enter [Password1] as new password (reusing same password)"
          - "Confirm new password ([Password1])"
          - "Save"
        expectedResult:
          - "Error message: \"This password has been used recently and you need to pick a different password\""
          - "Password is NOT changed"
          - "User remains on password change screen"
        notes: ""
      - testId: "TC-01.4"
        title: "Login with Expired Password - Successful Password Change"
        prerequisiteReference: "Continues from TC-01.1"
        actionSteps:
          - "Enter [Password1] as current password"
          - "Enter [Password2] as new password (different from [Password1])"
          - "Confirm new password ([Password2])"
          - "Save"
        expectedResult:
          - "Password change is successful"
          - "User is logged out"
          - "User is redirected back to login screen"
        notes: ""
      - testId: "TC-01.5"
        title: "Login with Expired Password - Login with New Password"
        prerequisiteReference: "Continues from TC-01.4"
        actionSteps:
          - "Enter [TestUser] from prerequisite"
          - "Enter [Password2]"
          - "Submit login"
        expectedResult:
          - "User successfully logs into the application"
          - "No password change prompt appears"
          - "User lands on application home/dashboard"
        notes: ""
  - id: "TC-02"
    title: "Authenticated User Password Change"
    description: "Tests voluntary password change by an authenticated user via the user menu."
    testCases:
      - testId: "TC-02.1"
        title: "Authenticated Password Change - Navigate to Change Password"
        prerequisiteReference: "Continues from TC-01.5"
        actionSteps:
          - "Click user icon in upper right corner of app"
          - "Select \"Change Password\" from menu"
        expectedResult:
          - "User is redirected to change password screen"
          - "Form displays current password field and new password fields"
        notes: ""
      - testId: "TC-02.2"
        title: "Authenticated Password Change - Successful Change"
        prerequisiteReference: "Continues from TC-02.1"
        actionSteps:
          - "Enter current password ([Password2])"
          - "Enter [Password3] as new password (different from [Password2])"
          - "Confirm new password ([Password3])"
          - "Save"
        expectedResult:
          - "Password change is successful"
          - "User is logged out"
          - "User is redirected back to login screen"
        notes: ""
      - testId: "TC-02.3"
        title: "Authenticated Password Change - Login with New Password"
        prerequisiteReference: "Continues from TC-02.2"
        actionSteps:
          - "Enter [TestUser] from prerequisite"
          - "Enter [Password3]"
          - "Submit login"
        expectedResult:
          - "User successfully logs into the application"
          - "User lands on application home/dashboard"
        notes: ""
  - id: "TC-03"
    title: "Forgot Password Flow"
    description: "Tests the forgot password functionality and password reset process."
    testCases:
      - testId: "TC-03.1"
        title: "Forgot Password - Request Reset with Username"
        prerequisiteReference: "Uses PRE-01 or PRE-02"
        actionSteps:
          - "Navigate to login page (sign out if logged in)"
          - "Click \"Forgot Password\" link"
          - "Enter [TestUser] from prerequisite"
          - "Click Submit"
        expectedResult:
          - "User is redirected to page prompting for username, email, or phone number"
          - "After submit, user receives confirmation message"
        notes: ""
      - testId: "TC-03.2"
        title: "Forgot Password - Receive Email and Enter Code"
        prerequisiteReference: "Continues from TC-03.1"
        actionSteps:
          - "Check [TestEmail] inbox for password reset email"
          - "Copy verification code to [TestEmailCode]"
          - "Enter [TestEmailCode] on the screen prompting for code"
          - "Submit"
        expectedResult:
          - "Email received at [TestEmail]"
          - "Screen prompts for verification code"
          - "After entering valid code, user is taken to password reset screen"
        notes: ""
      - testId: "TC-03.3"
        title: "Forgot Password - Attempt Reusing Recent Password"
        prerequisiteReference: "Continues from TC-03.2"
        actionSteps:
          - "On password reset screen, enter [Password3] as new password"
          - "Confirm password ([Password3])"
          - "Save"
        expectedResult:
          - "Error message: \"Password was recently used\""
          - "Password is NOT changed"
          - "User remains on password reset screen"
        notes: ""
      - testId: "TC-03.4"
        title: "Forgot Password - Successful Password Reset"
        prerequisiteReference: "Continues from TC-03.2"
        actionSteps:
          - "Enter [Password4] as new password (different from previous passwords)"
          - "Confirm password ([Password4])"
          - "Save"
        expectedResult:
          - "Password reset is successful"
          - "User is redirected back to login screen"
          - "Confirmation message displayed"
        notes: ""
      - testId: "TC-03.5"
        title: "Forgot Password - Login with New Password"
        prerequisiteReference: "Continues from TC-03.4"
        actionSteps:
          - "Enter [TestUser] from prerequisite"
          - "Enter [Password4]"
          - "Submit login"
        expectedResult:
          - "User successfully logs into the application"
          - "User lands on application home/dashboard"
        notes: ""
  - id: "TC-04"
    title: "Admin Set Temporary Password"
    description: "Tests admin ability to set a temporary password for another user, forcing password change on next login."
    testCases:
      - testId: "TC-04.1"
        title: "Admin Login and Navigate to Employee/Technician"
        prerequisiteReference: "Uses Admin + Target User"
        actionSteps:
          - "Log in with [AdminUsername] and [Password1]"
          - "Complete expired password flow if prompted (set to [Password2] and re-login)"
          - "Navigate to Employees or Technicians section (based on target user)"
          - "Go to detail page of [TestUser] (target user)"
        expectedResult:
          - "Admin successfully logs in"
          - "Admin can access detail page for [TestUser]"
        notes: ""
      - testId: "TC-04.2"
        title: "Admin Set Temporary Password"
        prerequisiteReference: "Continues from TC-04.1"
        actionSteps:
          - "In actions menu, select \"Temporary Password\""
          - "Enter [TempPassword] as new temporary password"
          - "Save"
        expectedResult:
          - "Temporary password is set successfully"
          - "Confirmation message displayed"
          - "[TestUser] password is now [TempPassword]"
        notes: ""
      - testId: "TC-04.3"
        title: "User Login with Temporary Password"
        prerequisiteReference: "Continues from TC-04.2"
        actionSteps:
          - "Sign out as admin"
          - "Navigate to login page (or mobile app for PRE-02)"
          - "Enter [TestUser]"
          - "Enter [TempPassword]"
          - "Submit login"
        expectedResult:
          - "User is prompted to change password at login"
          - "User is NOT asked for current password"
          - "Only new password and confirmation password fields displayed"
        notes: ""
      - testId: "TC-04.4"
        title: "User Set New Password After Temp Password"
        prerequisiteReference: "Continues from TC-04.3"
        actionSteps:
          - "Enter [Password5] as new password"
          - "Confirm password ([Password5])"
          - "Save"
        expectedResult:
          - "Password change is successful"
          - "User is logged out"
          - "User is redirected back to login screen"
        notes: ""
      - testId: "TC-04.5"
        title: "User Login with New Password After Temp"
        prerequisiteReference: "Continues from TC-04.4"
        actionSteps:
          - "Enter [TestUser]"
          - "Enter [Password5]"
          - "Submit login"
        expectedResult:
          - "User successfully logs into the application"
          - "User lands on application home/dashboard"
        notes: ""
  - id: "TC-05"
    title: "Tenant Management Temporary Impersonation Password"
    description: "Tests the tenant management impersonation feature where a temporary password is provided for mobile technician login. Note: This test case is only for PRE-02 (Technician on Mobile)."
    testCases:
      - testId: "TC-05.1"
        title: "Generate Impersonation Password from Tenant Management"
        prerequisiteReference: "Uses PRE-02"
        actionSteps:
          - "Log in to your ST account"
          - "Navigate to Tenant Management"
          - "Find the tenant you are testing"
          - "Locate PRE-02 technician ([Username2])"
          - "Click \"Impersonate on Mobile\""
          - "Copy the provided temporary password to [ImpersonationPassword]"
        expectedResult:
          - "Temporary impersonation password is displayed"
          - "Password is copied to [ImpersonationPassword] variable"
        notes: ""
      - testId: "TC-05.2"
        title: "Login with Impersonation Password on Mobile"
        prerequisiteReference: "Continues from TC-05.1"
        actionSteps:
          - "Navigate to login page on mobile device or Android Studio"
          - "Enter [Username2]"
          - "Enter [ImpersonationPassword]"
          - "Submit login"
        expectedResult:
          - "User is logged in successfully (impersonated)"
          - "User is NOT asked to change or reset password"
          - "User lands on application home/dashboard"
        notes: ""

